---
/**
 * Gallery Page
 * Portfolio showcase with image grid
 * Images will be dynamically loaded from Sanity CMS
 */

import Layout from '../layouts/Layout.astro';

const base = import.meta.env.BASE_URL;

// Demo gallery items with category-relevant stock photography from Unsplash
// Curated to avoid religious imagery (except Jewish weddings) and match categories
const demoImages = [
  // Weddings Category
  {
    id: 1,
    title: 'Wedding Ceremony',
    category: 'Weddings',
    alt: 'Bride and groom during outdoor wedding ceremony',
    imageUrl: 'https://images.unsplash.com/photo-1519741497674-611481863552?w=800&h=600&fit=crop'
  },
  {
    id: 2,
    title: 'Bridal Portrait',
    category: 'Weddings',
    alt: 'Elegant bride in wedding gown',
    imageUrl: 'https://images.unsplash.com/photo-1606800052052-a08af7148866?w=800&h=600&fit=crop'
  },
  {
    id: 3,
    title: 'Wedding Details',
    category: 'Weddings',
    alt: 'Wedding rings and flowers',
    imageUrl: 'https://images.unsplash.com/photo-1520854221256-17451cc331bf?w=800&h=600&fit=crop'
  },
  {
    id: 4,
    title: 'Reception Celebration',
    category: 'Weddings',
    alt: 'Wedding reception with guests celebrating',
    imageUrl: 'https://images.unsplash.com/photo-1511285560929-80b456fea0bc?w=800&h=600&fit=crop'
  },
  {
    id: 5,
    title: 'First Dance',
    category: 'Weddings',
    alt: 'Couple sharing first dance at reception',
    imageUrl: 'https://images.unsplash.com/photo-1465495976277-4387d4b0b4c6?w=800&h=600&fit=crop'
  },

  // Portraits Category
  {
    id: 6,
    title: 'Professional Headshot',
    category: 'Portraits',
    alt: 'Professional business portrait',
    imageUrl: 'https://images.unsplash.com/photo-1573496359142-b8d87734a5a2?w=800&h=600&fit=crop'
  },
  {
    id: 7,
    title: 'Family Portrait',
    category: 'Portraits',
    alt: 'Warm family portrait session outdoors',
    imageUrl: 'https://images.unsplash.com/photo-1511895426328-dc8714191300?w=800&h=600&fit=crop'
  },
  {
    id: 8,
    title: 'Senior Portrait',
    category: 'Portraits',
    alt: 'High school senior portrait session',
    imageUrl: 'https://images.unsplash.com/photo-1531746020798-e6953c6e8e04?w=800&h=600&fit=crop'
  },
  {
    id: 9,
    title: 'Creative Portrait',
    category: 'Portraits',
    alt: 'Artistic portrait with natural lighting',
    imageUrl: 'https://images.unsplash.com/photo-1529626455594-4ff0802cfb7e?w=800&h=600&fit=crop'
  },
  {
    id: 10,
    title: 'Child Portrait',
    category: 'Portraits',
    alt: 'Candid child portrait outdoors',
    imageUrl: 'https://images.unsplash.com/photo-1503454537195-1dcabb73ffb9?w=800&h=600&fit=crop'
  },

  // Concerts Category - Rock and Roll!
  {
    id: 11,
    title: 'Live Performance',
    category: 'Concerts',
    alt: 'Band performing live on stage with dramatic lighting',
    imageUrl: 'https://images.unsplash.com/photo-1501386761578-eac5c94b800a?w=800&h=600&fit=crop'
  },
  {
    id: 12,
    title: 'Rock Concert Energy',
    category: 'Concerts',
    alt: 'Energetic rock concert with crowd',
    imageUrl: 'https://images.unsplash.com/photo-1470229722913-7c0e2dbbafd3?w=800&h=600&fit=crop'
  },
  {
    id: 13,
    title: 'Band Promo Shot',
    category: 'Concerts',
    alt: 'Professional band promotional photography',
    imageUrl: 'https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?w=800&h=600&fit=crop'
  },
  {
    id: 14,
    title: 'Intimate Club Show',
    category: 'Concerts',
    alt: 'Live music in intimate club venue',
    imageUrl: 'https://images.unsplash.com/photo-1516450360452-9312f5e86fc7?w=800&h=600&fit=crop'
  },
  {
    id: 15,
    title: 'Guitarist in Action',
    category: 'Concerts',
    alt: 'Guitarist performing on stage',
    imageUrl: 'https://images.unsplash.com/photo-1510915361894-db8b60106cb1?w=800&h=600&fit=crop'
  },

  // Events Category
  {
    id: 16,
    title: 'Birthday Celebration',
    category: 'Events',
    alt: 'Birthday party with cake and candles',
    imageUrl: 'https://images.unsplash.com/photo-1530103862676-de8c9debad1d?w=800&h=600&fit=crop'
  },
  {
    id: 17,
    title: 'Corporate Event',
    category: 'Events',
    alt: 'Professional business conference',
    imageUrl: 'https://images.unsplash.com/photo-1540575467063-178a50c2df87?w=800&h=600&fit=crop'
  },
  {
    id: 18,
    title: 'Graduation Ceremony',
    category: 'Events',
    alt: 'Graduate in cap and gown',
    imageUrl: 'https://images.unsplash.com/photo-1627556704353-43c2e5a62814?w=800&h=600&fit=crop'
  },
  {
    id: 19,
    title: 'Anniversary Party',
    category: 'Events',
    alt: 'Anniversary celebration with family',
    imageUrl: 'https://images.unsplash.com/photo-1464366400600-7168b8af9bc3?w=800&h=600&fit=crop'
  },
  {
    id: 20,
    title: 'Bar/Bat Mitzvah',
    category: 'Events',
    alt: 'Jewish coming of age celebration',
    imageUrl: 'https://images.unsplash.com/photo-1478146896981-b80fe463b330?w=800&h=600&fit=crop'
  },
];
---

<Layout
  title="Gallery - In Focus with Jodi"
  description="Browse our portfolio of professional photography including weddings, portraits, and events."
>
  <div class="gallery-page">
    <!-- Page Header -->
    <section class="page-header">
      <div class="header-container">
        <h1 class="page-title">Portfolio Gallery</h1>
        <p class="page-description">
          Explore a curated selection of my work across weddings, portraits, and special events.
        </p>
      </div>
    </section>

    <!-- Filter Options -->
    <section class="filter-section">
      <div class="filter-container">
        <div class="filter-label" id="filter-label">Filter by:</div>
        <div class="filter-buttons" role="group" aria-labelledby="filter-label">
          <button class="filter-btn filter-btn-active" data-filter="all" aria-pressed="true">
            All
          </button>
          <button class="filter-btn" data-filter="Weddings" aria-pressed="false">
            Weddings
          </button>
          <button class="filter-btn" data-filter="Portraits" aria-pressed="false">
            Portraits
          </button>
          <button class="filter-btn" data-filter="Concerts" aria-pressed="false">
            Concerts
          </button>
          <button class="filter-btn" data-filter="Events" aria-pressed="false">
            Events
          </button>
        </div>
      </div>
    </section>

    <!-- Gallery Grid -->
    <section class="gallery-section">
      <div class="gallery-container">
        <div class="gallery-grid" id="gallery-grid">
          {demoImages.map((image, index) => (
            <article class="gallery-item" data-category={image.category}>
              <button
                type="button"
                class="image-button"
                data-index={index}
                aria-label={`View ${image.title}`}
              >
                <div class="image-wrapper">
                  <img
                    src={image.imageUrl}
                    alt={image.alt}
                    class="gallery-image"
                    loading="lazy"
                  />
                </div>
                <div class="item-info">
                  <h3 class="item-title">{image.title}</h3>
                  <span class="item-category">{image.category}</span>
                </div>
              </button>
            </article>
          ))}
        </div>
      </div>
    </section>

    <!-- Lightbox Modal -->
    <div
      class="lightbox"
      id="lightbox"
      role="dialog"
      aria-modal="true"
      aria-label="Image viewer"
      hidden
    >
      <div class="lightbox-backdrop" id="lightbox-backdrop"></div>
      <div class="lightbox-content">
        <button
          type="button"
          class="lightbox-close"
          id="lightbox-close"
          aria-label="Close lightbox"
        >
          <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
          </svg>
        </button>

        <button
          type="button"
          class="lightbox-nav lightbox-prev"
          id="lightbox-prev"
          aria-label="Previous image"
        >
          <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
          </svg>
        </button>

        <div class="lightbox-image-container">
          <img
            id="lightbox-image"
            class="lightbox-image"
            src=""
            alt=""
          />
          <div class="lightbox-caption">
            <h3 id="lightbox-title" class="lightbox-title"></h3>
            <p id="lightbox-counter" class="lightbox-counter"></p>
          </div>
        </div>

        <button
          type="button"
          class="lightbox-nav lightbox-next"
          id="lightbox-next"
          aria-label="Next image"
        >
          <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
          </svg>
        </button>
      </div>
    </div>

    <!-- Call to Action -->
    <section class="cta-section">
      <div class="cta-container">
        <h2 class="cta-title">Like What You See?</h2>
        <p class="cta-description">
          Let's create beautiful photographs together. Book your session today.
        </p>
        <a href={`${base}/book`} class="btn btn-primary">
          Book a Session
        </a>
      </div>
    </section>
  </div>
</Layout>

<style>
  .gallery-page {
    background-color: var(--color-background);
  }

  /* Page Header */
  .page-header {
    background: var(--color-primary-50);
    padding: var(--spacing-16) 0 var(--spacing-12);
  }

  .header-container {
    max-width: var(--container-lg);
    margin: 0 auto;
    padding: 0 var(--spacing-4);
    text-align: center;
  }

  .page-title {
    font-size: var(--font-size-4xl);
    font-weight: var(--font-weight-bold);
    color: var(--color-text-primary);
    margin: 0 0 var(--spacing-4);
  }

  .page-description {
    font-size: var(--font-size-lg);
    line-height: var(--line-height-relaxed);
    color: var(--color-text-secondary);
    max-width: 600px;
    margin: 0 auto;
  }

  /* Filter Section */
  .filter-section {
    padding: var(--spacing-8) 0;
    border-bottom: 1px solid var(--color-border);
    background-color: var(--color-surface);
  }

  .filter-container {
    max-width: var(--container-xl);
    margin: 0 auto;
    padding: 0 var(--spacing-4);
    display: flex;
    flex-wrap: wrap;
    gap: var(--spacing-4);
    align-items: center;
    justify-content: center;
  }

  .filter-label {
    font-weight: var(--font-weight-semibold);
    color: var(--color-text-primary);
  }

  .filter-buttons {
    display: flex;
    flex-wrap: wrap;
    gap: var(--spacing-2);
  }

  .filter-btn {
    padding: var(--spacing-2) var(--spacing-4);
    font-size: var(--font-size-sm);
    font-weight: var(--font-weight-medium);
    background-color: transparent;
    color: var(--color-text-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    transition: all var(--transition-fast);
  }

  .filter-btn:hover {
    background-color: var(--color-neutral-100);
    color: var(--color-text-primary);
  }

  .filter-btn-active {
    background-color: var(--color-primary-600);
    color: #ffffff;
    border-color: var(--color-primary-600);
  }

  /* Gallery Section */
  .gallery-section {
    padding: var(--spacing-12) 0;
  }

  .gallery-container {
    max-width: var(--container-2xl);
    margin: 0 auto;
    padding: 0 var(--spacing-4);
  }

  .gallery-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: var(--spacing-6);
  }

  .gallery-item {
    background-color: var(--color-surface);
    border-radius: var(--radius-xl);
    overflow: hidden;
    box-shadow: var(--shadow-base);
    transition: all var(--transition-base);
  }

  .gallery-item:hover {
    box-shadow: var(--shadow-lg);
    transform: translateY(-4px);
  }

  .gallery-item.hidden {
    display: none;
  }

  .image-button {
    width: 100%;
    background: none;
    border: none;
    padding: 0;
    cursor: pointer;
    text-align: left;
  }

  .image-button:focus-visible {
    outline: 3px solid var(--color-primary-600);
    outline-offset: 4px;
  }

  .image-wrapper {
    position: relative;
    width: 100%;
    overflow: hidden;
    aspect-ratio: 4 / 3;
    background-color: var(--color-neutral-100);
  }

  .gallery-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
    transition: transform var(--transition-base);
  }

  .gallery-item:hover .gallery-image {
    transform: scale(1.05);
  }

  .item-info {
    padding: var(--spacing-4);
  }

  .item-title {
    font-size: var(--font-size-lg);
    font-weight: var(--font-weight-semibold);
    color: var(--color-text-primary);
    margin: 0 0 var(--spacing-2);
  }

  .item-category {
    display: inline-block;
    font-size: var(--font-size-sm);
    color: var(--color-text-secondary);
    background-color: var(--color-neutral-100);
    padding: var(--spacing-1) var(--spacing-3);
    border-radius: var(--radius-full);
  }

  /* CTA Section */
  .cta-section {
    padding: var(--spacing-20) 0;
    background-color: var(--color-surface);
    border-top: 1px solid var(--color-border);
  }

  .cta-container {
    max-width: var(--container-md);
    margin: 0 auto;
    padding: 0 var(--spacing-4);
    text-align: center;
  }

  .cta-title {
    font-size: var(--font-size-3xl);
    font-weight: var(--font-weight-bold);
    color: var(--color-text-primary);
    margin: 0 0 var(--spacing-4);
  }

  .cta-description {
    font-size: var(--font-size-lg);
    line-height: var(--line-height-relaxed);
    color: var(--color-text-secondary);
    margin: 0 0 var(--spacing-8);
  }

  .btn {
    display: inline-block;
    padding: var(--spacing-3) var(--spacing-6);
    font-size: var(--font-size-base);
    font-weight: var(--font-weight-semibold);
    text-decoration: none;
    border-radius: var(--radius-lg);
    transition: all var(--transition-base);
    border: 2px solid transparent;
  }

  .btn-primary {
    background-color: var(--color-primary-600);
    color: var(--color-text-inverse);
  }

  .btn-primary:hover {
    background-color: var(--color-primary-700);
  }

  /* Lightbox */
  .lightbox {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: var(--z-modal);
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .lightbox[hidden] {
    display: none;
  }

  .lightbox-backdrop {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.95);
  }

  .lightbox-content {
    position: relative;
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: var(--spacing-16) var(--spacing-4);
  }

  .lightbox-close {
    position: absolute;
    top: var(--spacing-4);
    right: var(--spacing-4);
    width: 3rem;
    height: 3rem;
    display: flex;
    align-items: center;
    justify-content: center;
    background-color: rgba(0, 0, 0, 0.5);
    border: none;
    border-radius: var(--radius-full);
    color: white;
    cursor: pointer;
    transition: background-color var(--transition-fast);
    z-index: 10;
  }

  .lightbox-close:hover {
    background-color: rgba(0, 0, 0, 0.8);
  }

  .lightbox-close:focus-visible {
    outline: 3px solid var(--color-accent-400);
    outline-offset: 2px;
  }

  .lightbox-close svg {
    width: 1.5rem;
    height: 1.5rem;
  }

  .lightbox-nav {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    width: 3rem;
    height: 3rem;
    display: flex;
    align-items: center;
    justify-content: center;
    background-color: rgba(0, 0, 0, 0.5);
    border: none;
    border-radius: var(--radius-full);
    color: white;
    cursor: pointer;
    transition: background-color var(--transition-fast);
    z-index: 10;
  }

  .lightbox-nav:hover {
    background-color: rgba(0, 0, 0, 0.8);
  }

  .lightbox-nav:focus-visible {
    outline: 3px solid var(--color-accent-400);
    outline-offset: 2px;
  }

  .lightbox-nav svg {
    width: 1.5rem;
    height: 1.5rem;
  }

  .lightbox-prev {
    left: var(--spacing-4);
  }

  .lightbox-next {
    right: var(--spacing-4);
  }

  .lightbox-image-container {
    max-width: 90%;
    max-height: 85%;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--spacing-4);
  }

  .lightbox-image {
    max-width: 100%;
    max-height: 100%;
    width: auto;
    height: auto;
    object-fit: contain;
    border-radius: var(--radius-lg);
  }

  .lightbox-caption {
    text-align: center;
    color: white;
  }

  .lightbox-title {
    font-size: var(--font-size-lg);
    font-weight: var(--font-weight-semibold);
    margin: 0 0 var(--spacing-2);
  }

  .lightbox-counter {
    font-size: var(--font-size-sm);
    color: var(--color-neutral-300);
    margin: 0;
  }

  /* Responsive */
  @media (min-width: 640px) {
    .gallery-grid {
      grid-template-columns: repeat(2, 1fr);
    }
  }

  @media (min-width: 1024px) {
    .gallery-grid {
      grid-template-columns: repeat(3, 1fr);
    }

    .page-title {
      font-size: var(--font-size-5xl);
    }
  }

  /* Dark Mode - Manual override via data-theme attribute */
  html[data-theme='dark'] .filter-btn {
    background-color: var(--color-neutral-700) !important;
    color: var(--color-neutral-300) !important;
    border-color: var(--color-neutral-600) !important;
  }

  html[data-theme='dark'] .filter-btn:hover {
    background-color: var(--color-neutral-600) !important;
    color: var(--color-neutral-50) !important;
    border-color: var(--color-neutral-500) !important;
  }

  html[data-theme='dark'] .filter-btn-active,
  html[data-theme='dark'] .filter-btn[aria-pressed="true"] {
    background-color: var(--color-primary-600) !important;
    color: #ffffff !important;
    border-color: var(--color-primary-600) !important;
  }

  html[data-theme='dark'] .cta-title {
    color: var(--color-text-inverse);
  }

  html[data-theme='dark'] .cta-description {
    color: var(--color-text-inverse);
  }

  html[data-theme='dark'] .btn-primary {
    color: #ffffff;
  }
</style>

<script>
  // Gallery data
  const images = [
    {
      id: 1,
      title: 'Wedding Ceremony',
      category: 'Weddings',
      alt: 'Bride and groom during outdoor wedding ceremony',
      imageUrl: 'https://images.unsplash.com/photo-1519741497674-611481863552?w=1200&h=900&fit=crop'
    },
    {
      id: 2,
      title: 'Bridal Portrait',
      category: 'Weddings',
      alt: 'Elegant bride in wedding gown',
      imageUrl: 'https://images.unsplash.com/photo-1606800052052-a08af7148866?w=1200&h=900&fit=crop'
    },
    {
      id: 3,
      title: 'Wedding Details',
      category: 'Weddings',
      alt: 'Wedding rings and flowers',
      imageUrl: 'https://images.unsplash.com/photo-1520854221256-17451cc331bf?w=1200&h=900&fit=crop'
    },
    {
      id: 4,
      title: 'Reception Celebration',
      category: 'Weddings',
      alt: 'Wedding reception with guests celebrating',
      imageUrl: 'https://images.unsplash.com/photo-1511285560929-80b456fea0bc?w=1200&h=900&fit=crop'
    },
    {
      id: 5,
      title: 'First Dance',
      category: 'Weddings',
      alt: 'Couple sharing first dance at reception',
      imageUrl: 'https://images.unsplash.com/photo-1465495976277-4387d4b0b4c6?w=1200&h=900&fit=crop'
    },
    {
      id: 6,
      title: 'Professional Headshot',
      category: 'Portraits',
      alt: 'Professional business portrait',
      imageUrl: 'https://images.unsplash.com/photo-1573496359142-b8d87734a5a2?w=1200&h=900&fit=crop'
    },
    {
      id: 7,
      title: 'Family Portrait',
      category: 'Portraits',
      alt: 'Warm family portrait session outdoors',
      imageUrl: 'https://images.unsplash.com/photo-1511895426328-dc8714191300?w=1200&h=900&fit=crop'
    },
    {
      id: 8,
      title: 'Senior Portrait',
      category: 'Portraits',
      alt: 'High school senior portrait session',
      imageUrl: 'https://images.unsplash.com/photo-1531746020798-e6953c6e8e04?w=1200&h=900&fit=crop'
    },
    {
      id: 9,
      title: 'Creative Portrait',
      category: 'Portraits',
      alt: 'Artistic portrait with natural lighting',
      imageUrl: 'https://images.unsplash.com/photo-1529626455594-4ff0802cfb7e?w=1200&h=900&fit=crop'
    },
    {
      id: 10,
      title: 'Child Portrait',
      category: 'Portraits',
      alt: 'Candid child portrait outdoors',
      imageUrl: 'https://images.unsplash.com/photo-1503454537195-1dcabb73ffb9?w=1200&h=900&fit=crop'
    },
    {
      id: 11,
      title: 'Live Performance',
      category: 'Concerts',
      alt: 'Band performing live on stage with dramatic lighting',
      imageUrl: 'https://images.unsplash.com/photo-1501386761578-eac5c94b800a?w=1200&h=900&fit=crop'
    },
    {
      id: 12,
      title: 'Rock Concert Energy',
      category: 'Concerts',
      alt: 'Energetic rock concert with crowd',
      imageUrl: 'https://images.unsplash.com/photo-1470229722913-7c0e2dbbafd3?w=1200&h=900&fit=crop'
    },
    {
      id: 13,
      title: 'Band Promo Shot',
      category: 'Concerts',
      alt: 'Professional band promotional photography',
      imageUrl: 'https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?w=1200&h=900&fit=crop'
    },
    {
      id: 14,
      title: 'Intimate Club Show',
      category: 'Concerts',
      alt: 'Live music in intimate club venue',
      imageUrl: 'https://images.unsplash.com/photo-1516450360452-9312f5e86fc7?w=1200&h=900&fit=crop'
    },
    {
      id: 15,
      title: 'Guitarist in Action',
      category: 'Concerts',
      alt: 'Guitarist performing on stage',
      imageUrl: 'https://images.unsplash.com/photo-1510915361894-db8b60106cb1?w=1200&h=900&fit=crop'
    },
    {
      id: 16,
      title: 'Birthday Celebration',
      category: 'Events',
      alt: 'Birthday party with cake and candles',
      imageUrl: 'https://images.unsplash.com/photo-1530103862676-de8c9debad1d?w=1200&h=900&fit=crop'
    },
    {
      id: 17,
      title: 'Corporate Event',
      category: 'Events',
      alt: 'Professional business conference',
      imageUrl: 'https://images.unsplash.com/photo-1540575467063-178a50c2df87?w=1200&h=900&fit=crop'
    },
    {
      id: 18,
      title: 'Graduation Ceremony',
      category: 'Events',
      alt: 'Graduate in cap and gown',
      imageUrl: 'https://images.unsplash.com/photo-1627556704353-43c2e5a62814?w=1200&h=900&fit=crop'
    },
    {
      id: 19,
      title: 'Anniversary Party',
      category: 'Events',
      alt: 'Anniversary celebration with family',
      imageUrl: 'https://images.unsplash.com/photo-1464366400600-7168b8af9bc3?w=1200&h=900&fit=crop'
    },
    {
      id: 20,
      title: 'Bar/Bat Mitzvah',
      category: 'Events',
      alt: 'Jewish coming of age celebration',
      imageUrl: 'https://images.unsplash.com/photo-1478146896981-b80fe463b330?w=1200&h=900&fit=crop'
    },
  ];

  // State
  let currentFilter = 'all';
  let currentImageIndex = 0;
  let visibleImages: typeof images = [];

  // DOM elements
  const filterButtons = document.querySelectorAll('.filter-btn');
  const galleryItems = document.querySelectorAll('.gallery-item');
  const imageButtons = document.querySelectorAll('.image-button');
  const lightbox = document.getElementById('lightbox');
  const lightboxImage = document.getElementById('lightbox-image') as HTMLImageElement;
  const lightboxTitle = document.getElementById('lightbox-title');
  const lightboxCounter = document.getElementById('lightbox-counter');
  const lightboxClose = document.getElementById('lightbox-close');
  const lightboxBackdrop = document.getElementById('lightbox-backdrop');
  const lightboxPrev = document.getElementById('lightbox-prev');
  const lightboxNext = document.getElementById('lightbox-next');

  // Filter functionality
  filterButtons.forEach(button => {
    button.addEventListener('click', () => {
      const filter = button.getAttribute('data-filter');
      currentFilter = filter || 'all';

      // Update active state
      filterButtons.forEach(btn => {
        btn.classList.remove('filter-btn-active');
        btn.setAttribute('aria-pressed', 'false');
      });
      button.classList.add('filter-btn-active');
      button.setAttribute('aria-pressed', 'true');

      // Filter items
      galleryItems.forEach(item => {
        const category = item.getAttribute('data-category');

        if (currentFilter === 'all' || category === currentFilter) {
          item.classList.remove('hidden');
        } else {
          item.classList.add('hidden');
        }
      });
    });
  });

  // Lightbox functionality
  const updateVisibleImages = () => {
    visibleImages = currentFilter === 'all'
      ? images
      : images.filter(img => img.category === currentFilter);
  };

  const openLightbox = (globalIndex: number) => {
    updateVisibleImages();

    // Find the index in the visible images array
    const clickedImage = images[globalIndex];
    currentImageIndex = visibleImages.findIndex(img => img.id === clickedImage.id);

    if (currentImageIndex === -1) currentImageIndex = 0;

    updateLightboxImage();
    if (lightbox) {
      lightbox.removeAttribute('hidden');
      document.body.style.overflow = 'hidden';

      // Focus the close button for keyboard accessibility
      if (lightboxClose) {
        (lightboxClose as HTMLElement).focus();
      }
    }
  };

  const closeLightbox = () => {
    if (lightbox) {
      lightbox.setAttribute('hidden', '');
      document.body.style.overflow = '';
    }
  };

  const updateLightboxImage = () => {
    const image = visibleImages[currentImageIndex];
    if (image && lightboxImage && lightboxTitle && lightboxCounter) {
      lightboxImage.src = image.imageUrl;
      lightboxImage.alt = image.alt;
      lightboxTitle.textContent = image.title;
      lightboxCounter.textContent = `${currentImageIndex + 1} of ${visibleImages.length}`;
    }
  };

  const showPrevImage = () => {
    currentImageIndex = (currentImageIndex - 1 + visibleImages.length) % visibleImages.length;
    updateLightboxImage();
  };

  const showNextImage = () => {
    currentImageIndex = (currentImageIndex + 1) % visibleImages.length;
    updateLightboxImage();
  };

  // Event listeners
  imageButtons.forEach((button, index) => {
    button.addEventListener('click', () => {
      openLightbox(index);
    });
  });

  if (lightboxClose) {
    lightboxClose.addEventListener('click', closeLightbox);
  }

  if (lightboxBackdrop) {
    lightboxBackdrop.addEventListener('click', closeLightbox);
  }

  if (lightboxPrev) {
    lightboxPrev.addEventListener('click', showPrevImage);
  }

  if (lightboxNext) {
    lightboxNext.addEventListener('click', showNextImage);
  }

  // Keyboard navigation
  document.addEventListener('keydown', (e) => {
    if (lightbox && !lightbox.hasAttribute('hidden')) {
      if (e.key === 'Escape') {
        closeLightbox();
      } else if (e.key === 'ArrowLeft') {
        showPrevImage();
      } else if (e.key === 'ArrowRight') {
        showNextImage();
      }
    }
  });
</script>
